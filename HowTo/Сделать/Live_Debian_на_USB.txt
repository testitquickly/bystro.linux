Content-Type: text/x-zim-wiki
Wiki-Format: zim 0.6
Creation-Date: 2025-05-30T21:59:33+03:00

====== Live Debian на USB ======

[ @live @usb @balena @unetbootin @dd  ]

Взять 
* чистую USB-flash от 4Gb или DVD.
* iso-образ Debian Live
	* https://www.debian.org/CD/live/
	* или в архиве https://archive.org/download/debian-12-bookworm-collection/12.11/Debian%20Live%20%28amd64%29/

===== Накатить образ на флэшку =====

Есть грубо-однозначные установщики на очень маленькие флэшки

* [[Software:Unetbootin]]
* [[Debian:Install:Balena etcher]]

Они воспринимают любую флэшку как «одну единицу чего-то» и накатывают на неё образ Debian одним движением, делая флэшку read only. Для образа нужно 3 или 4 Gb, и если флэшка будет размером с 30 Gb, то 

* будет размечена нужная область на 4 Gb
* и добавлен небольшой служебный раздел на несколько Mb
* а всё остальное будет и неразмечено, и в принципе недоступно. Если будет нужно какие-то скрипты взять на борт флэшки, то уже нет.

Но можно сделать всё вручную в консоли.

==== Подготовка ====

Разумно сперва отформатировать флэшку и оставить на ней одну партицию, чтобы она идентифицировалась однозначно. Это можно сделать через «Диспетчер разделов от KDE» или GParted:

* воткнуть флэшку в ноут, но не монтировать ее партицию.
* «Диспетчер разделов от KDE» > найти устройство, и если есть разделы > протыкать каждый и выбрать Delete > Применить.
* найти флэшку в консоли

''lsblk''

Пример ответа:

''sda  8:0    1    30G  0 disk'' 

Аккуратно смотреть все пути, чтобы случайно не затереть другие партиции.

Условно:

* путь к партициям на флэшке: ''/dev/sda''
* путь к образу iso: ''/home/astenix/Install/Debian/debian-live-12.11.0-amd64-kde.iso''

==== Записать ISO на флешку ====

''sudo dd if=/home/astenix/Install/Debian/debian-live-12.11.0-amd64-kde.iso of=/dev/sda bs=4M status=progress conv=fsync''

==== Добавить место для файлов ====

Проверить свободное пространство на флэшке.

''sudo parted /dev/sda print free''

или

''sudo fdisk -l /dev/sda''

Скорее всего, после записи iso на флешке появится старый DOS MBR (msdos) раздел, и свободное место будет отображаться некорректно. Например, 128 Gb вместо реальных 30 Gb:

''Start=8288kB, End=129GB''

Можно проверить свободное место через «Диспетчер разделов от KDE». Однако создать партицию на неразмеченном месте там же будет невозможно.

Вот надежный способ:

''sudo fdisk /dev/sda''

Дальше надо последовательно ввести команды (одна клавиша):

* ''n'' (new partition)
* ''p'' (Primary, выбор типа раздела для выбранного диска)
* 3 ''(''цифра, номер раздела, в котором будет создана новая партиция; по умолчанию следующий свободный, может быть несколько свободных)
* указать ''First sector'': просто нажать Enter
* указать ''Last sector'': тоже Enter (подразумевается, что просто создаем новую партицию на все доступное свободное место)

Дождаться сообщения вроде

''Created a new partition 3 of type 'Linux' and of size 26,7 GiB.''

* ''w'' (write and exit)

Проверить результат:

''lsblk -f''

Если отображается партиция ''sda3'' — все ок.

Создать новый раздел в формате fat32 на свободном пространстве и задать ему метку “''myFiles''”:

''sudo mkfs.vfat -F32 -n myFiles /dev/sda3''

Монтируем его:

''sudo mkdir -p /mnt/myFiles && sudo mount /dev/sda3 /mnt/myFiles''

Учесть, что запись доступна только для sudo. Назначить владельца для партиции FAT32 невозможно, поэтому 

''sudo mc'' 

Перенести нужные файлы.

Отмонтировать партицию:

''sudo umount /mnt/myFiles'' 

Флэшка с Debian Live готова.
