Content-Type: text/x-zim-wiki
Wiki-Format: zim 0.6
Creation-Date: 2022-02-22T15:17:00+02:00

====== Панель задач ======

[ @toolbar @copy @window @virtual_desktops @fonts @time @calendar @погода ]

===== Заменить виджет «Меню запуска приложений» =====

Всегда удобнее для восприятия классический вид меню.

'''
Правый клик мышью по иконке меню запуска приложений
> Взаимозаменяемые виджеты
> «Классическое меню приложений»
'''

Ещё можно заменить иконку через настройку этого виджета.

===== Заменить виджет с иконкам на виджет с окнами =====

Кликнуть правой кнопкой мыши по свободному месту на тулбаре 
'''
> Взаимозаменяемые виджеты
> Выбрать виджет с названием «Панель задач»
> [Заменить]
'''

===== Настроить виджет «Панель задач» =====

Правой кнопкой мыши по иконке любого открытого приложения (тот же Dolphin) 

'''
> Дополнительно 
> Настроить виджет «Панель задач»
> Внешний вид
> Основное
'''

	* Убрать галочку «Показывать всплывающие подсказки» (это подавление превью окон в тулбаре)
	* Убрать галочку «Подсветка окна при наведении на соответствующий элемент в панели задач
	* Поставить галочку «Помечать приложения, которые воспроизводят звук»
	* Поставить галочку «Не начинать новый столбец, пока он не заполнится максимально»
	* [Применить]

**> Поведение**

	* Группировка: Не группировать
	* Сортировка: Вручную
	* Поставить галочку «Запретить перемешивать с кнопками запуска»
	* Убрать галочку «Колесо мыши: Переключение между приложениями»
	* [Применить]

**> Показывать приложения**

	* Убрать галочку «С текущего экрана»
	* Поставить галочку «С текущего рабочего стола»
	* Поставить галочку «Из текущей комнаты»
	* Убрать галочку «Свёрнутые»

[ОК]

===== Прогресс-бар при копировании и удалении файлов =====

Мне не нравится отображение прогресс-бара в трее, хочу видеть это в отдельном окне. 

'''
Параметры системы 
> Предпочтения пользователя
> Уведомления

'''
Пройтись последовательно по всем разделам:

''> Режим «Не беспокоить»''

* Убрать галочку »При дублировании изображения на главный экран».
* Поставить галочку «Выводить критические уведомления — Показывать в режиме “Не беспокоить”»

''> Критические уведомления''

* Поставить галочку «Всегда поверх других окон»

''> Обычные уведомления''

* Убрать галочку.

''> Неприоритетные уведомления''

* Убрать галочку.

''> Выпадающие уведомления''

* Переключить радиобаттон на [Задать собственное расположение…] и указать место на экране (правый верхний угол)
* Скрывать через: 3 секунды

''> Ход выполнения''

* Убрать галочку «Показывать на панели задач»
* Убрать галочку «Показывать в уведомлениях»

''> Счетчики уведомления''

* Убрать галочку «Показывать в диспетчере задач»
* [Применить]

Запустить/Перезапустить Dolphin. Инициировать копирование крупного файла, убедиться в том, что на тулбаре появляется отдельное окно копирования.

===== Настроить отображение окон =====

'''
Параметры системы 
> Рабочая среда 
> Поведение рабочей среды 
> Эффекты рабочего стола
> справа от панели «Поиск» кликнуть по кнопке «Настроить фильтр»
'''

* убрать галочку "Скрыть внутренние эффекты" 
* в разделе «Внешний вид» убрать галочку "Подсвечивать окно"
* [Применить]

===== Настроить основные параметры рабочей среды =====

'''
Параметры системы 
> Рабочая среда 
> Поведение рабочей среды 
> Основные параметры

'''
**Визуальное поведение**
* Поставить галочку «Всплывающие подсказки при наведении курсора мыши» (без неё над виджетом с часами не будет всплывать информация о таймзонах, например)
* Поставить галочку «Показывать уведомления при регулировке устройств»
**Поведение при нажатиях**
* Ординарный щелчок для открытия файлов и каталогов
[Применить]

===== Настроить виртуальные столы =====

'''
Параметры системы 
> Рабочая среда
> Поведение рабочей среды 
> Виртуальные рабочие столы
'''

* [Добавить] новый рабочий стол
* Настроить параметры перехода и анимации — «С переходом по циклу»
* [Применить]

На тулбаре появится иконка двух рабочих столов.

''Правой кнопкой по этой иконке''
''> Настроить виджет «Переключение рабочих столов»''
''> Основное''

* Снять галочку «Показывать значки приложений на схемах окон»
* Поставить галочку «Показывать только текущий экран» (это важная настройка для двухмониторных конфигураций)
* Поставить галочку «Навигация с переходом по циклу»
* Переключить радиобаттон «При выборе текущего рабочего стола: Не делать ничего»
* [ОК]

===== Виджет «Календарь событий» =====

Внимание, виджет ещё не работает в “Plasma 6”.

==== Заменить в трее часы на «Календарь событий» ====

'''
Правый клик мышью по часам в трее 
> Добавить виджеты
> В окне выбора виджетов выбрать [Пополнить список виджетов] 
> [Загрузить виджеты Plasma]
'''

'''
> В строке поиска написать «Event Calendar» 
> найти его и установить. 

'''
Если его там не будет, можно установить из https://github.com/Zren/plasma-applet-eventcalendar
'''

Правый клик мышью по часам в трее 
> «Взаимозаменяемые виджеты»
> выбрать «Календарь событий»
> [Заменить]
'''

==== Настроить внешний вид часов ====

'''
Правый клик мышью по часам в трее 
> настроить виджет «Календарь событий»
> Главная
'''

Опционально
* убрать галочку «Метеограмма» (для постоянного отображения прогноза погоды может быть удобнее отдельный +Виджет «Прогноз погоды»)
* убрать галочку «Таймер»

* Выбрать «Шрифт часов» — зависит от установленных шрифтов. Можно поставить курсор на поле выбора шрифта и покрутить колесо мыши.
	* Quicksand Medium — норм
	* IBM Plex Serif Text
	* Chivo Black — толсто, с засечками
	* Dante — толсто, вроде терминала, красиво
	* Open Sans Extra Bold — очень толсто, без засечек, красиво
	* Clear Sans — тонко
	* Helvetica — тонко
	* IBM Plex Sans Arabic Medm
	* IBM Plex Sans SemiBold
	* CO59[urw] — фигурно

В поле «Строка 1» можно вписать следующую инструкцию:

'''<font size="1" color="orange">48</font> <font size="2" color="#b8b2b2">'d MMM'</font>' HH:mm''

Первое число (48) — это номер недели в году. Он опционален. Чуть позже будет настроено его обновление.

Размеры шрифта здесь не в пикселях, можно указывать только значения в диапазоне от „1” (самый маленький) до „7“ (громадный). «Строка 2» можно не включать.

Первое число (22) — это номер недели. Хорошо бы обновлять его автоматически. В Linux за это отвечают две переменные:
* %U — week number of year, with Sunday as first day of week (00..53)
* %V — ISO week number, with Monday as first day of week (01..53) 
Подробнее см. https://www.cyberciti.biz/faq/linux-unix-formatting-dates-for-display/

Но в виджете не работают ни U, ни V.

Решение — вписывать нужное значение в конфиг-файл виджета, ''/home/astenix/.config/plasma-org.kde.plasma.desktop-appletsrc''

Это можно сделать в любой момент, но изменения в виджете применяются только после перезагрузки Plasma. Поэтому надо записывать номер недели  в файл настроек после запуска Plasma, но ДО загрузки моего профиля. Для этого я сделаю отдельный sh-скрипт, который будет запускаться при инициализации профиля.

В принципе можно не заводить это всё в отдельный sh-файл а записать три строки прямо в файл ''~/.bash_profile'', но тогда будет больше шансов продолбать этот файл при очередной переустановке системы.

=== Сделать скрипт ===

''mcedit /home/astenix/myScripts/kde/update_widget_EventCalendar.sh''

Этот скрипт читает содержимое файла с настройками виджета (fileToUpdate), находит в нём строку со временем и вставляет вместо числа „22” (которое постоянно меняется) содержимое из переменной “weekNumber” актуальный номер недели.

'''
#!/bin/bash
export TERM=linux

fileToUpdate="/home/astenix/.config/plasma-org.kde.plasma.desktop-appletsrc"
weekNumber=$(date +%V)

	# Обычно кавычки по бокам ординарные, но с ними переменная $weekNumber воспринимается как простой текст
	# чтобы подставлялось значение из переменной, надо весь запрос обрамлять снаружи двойными кавычками, и если они 
	# есть внутри запроса — экранировать их обратным слэшем, а ординарные экранировать не надо. Также надо экранировать
	# слэши из html. И ещё надо взять в двойные кавычки переменную с адресом файла, который надо обновить.

sed -E -i "s/clockTimeFormat1='<font size=\"1\" color=\"orange\">([0-9]+)<\/font>/clockTimeFormat1='<font size=\"1\" color=\"orange\">$weekNumber<\/font>/g" "$fileToUpdate"
'''

=== Сделать скрипт исполняемым ===

''chmod +x /home/astenix/myScripts/kde/update_widget_EventCalendar.sh''

=== Запланировать запуск скрипта ===

Обновить файл настроек виджета надо после запуска Plasma, но ДО загрузки моего профиля.

''mcedit ~/.bash_profile''

Вставить этот текст:

''if [ -f /home/astenix/myScripts/kde/update_widget_EventCalendar.sh ]; then    # проверяем, что sh-файл существует.''
	''. /home/astenix/myScripts/kde/update_widget_EventCalendar.sh                # если да, то выполняем его ПЕРЕД загрузкой профиля''

Теперь при каждой загрузке профиля (или при каждом включении ноута, если угодно) будет выполняться обновление предопределенной строки в настройках виджета. 

Есть смысл протестировать выполнение этого скрипта в полночь на понедельник.

=== Настроить «Команды запуска» ===

''> Главная'' 
''> Колесо мыши''

Возможность управлять громкостью звука колесом мыши, когда курсор над часами в трее. При уменьшении хорошо бы установить порог срабатывания в 15%, чтобы уменьшить звук быстро.

* Выбрать «Регулировка (без интерфейса) amixer»
* Прокрутка вверх = ''amixer -q sset Master 15%+''
* Прокрутка вниз = ''amixer -q sset Master 15%-''

Если нужно зримое отображение прогесс-бара при смене уровня звука, то лучше тыкнуть по «Регулировка (с интерфейсом) (qdbus)». В полях «Команды запуска» появятся команды
* ''qdbus org.kde.kglobalaccel /component/kmix invokeShortcut "increase_volume"''
* ''qdbus org.kde.kglobalaccel /component/kmix invokeShortcut "decrease_volume"''

=== Убрать галочку «Показать фон» ===

''> Главная'' 
''> Другое''

* Убрать галочку «Виджет рабочего стола: показать фон»

==== > Макет ====

Распорядок дня под календарём (Одна колонка)

==== > Часовые пояса ====

По-необходимости.

==== > Календарь ====

Чтобы добавить гуглокалендарь, в KDE обязательно надо включить использование бумажника для хранения паролей. Для бумажника можно (хотя и не очень нужно) задать пустой пароль — [[Сделать:Поменять пароль в кошельке kdewallet]]

И надо установить ''kdepim'' (KDE Personal Information Management):

''sudo aptitude install kalendar kdepim''

Галочки
* Показать календарь
* Показать номера недель
* Подсветка текущего дня/недели
* Первый день: понедельник
* Значок события: Точки
* Сегодняшний день: Светлая (на тёмном)

==== > Обзор дня ====

* галочка «Показать обзор дня» (выводить информацию о событиях в календаре)

* поставить галочку «Значок погоды»

==== > События ====

* убрать галочку «Праздники»
* поставить галочку «Модуль событий электронного секретаря»
* Обновлять события каждые «60 min»

==== > Google Calendar ====

Прямое подключение к календарю гугл черз виджет Event Calendar уже не работает и вряд ли будет. Надо подключить календарь через KOrganizer, который использует kdepim. Уже после этого настроить отображение своего календаря в виджете Event Calendar в разделе «Модуль событий электронного секретаря» — поставить галочки для календарей, которые должны отображаться в виджете (так работает Akonadi).

==== > Погода ====

Если приспичит, то Кишинев = 618426

==== > Модуль событий электронного секретаря ====

Убедиться в том, что добавленные в KOrganizer календари отображаются.

Развернуть из и проставить галочки для гуглокалендарей, которые надо отображать в виджете. [OK]

Развернуть виджет, в правом нижнем углу кликнуть по иконе „Reload”.

==== > Комбинации клавиш ====

Может быть удобно разворачивать представление календаря по нажатию [Ctrl+ScrollLock].

[OK]

===== Спрятать виджет с обновлениями =====

Это безопасно убирать только если сам через консоль регулярно делаешь ''apt-get update''

Настроить виджет "Системный лоток" (в трее рядом с часами правой кнопкой по ↓)
''> Состояния приложений''
''> Обновления'' = Всегда скрывать
''> Элементы''
''> Системные службы''
''> Уведомления'' = Отключить
