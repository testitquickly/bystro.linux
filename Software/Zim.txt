Content-Type: text/x-zim-wiki
Wiki-Format: zim 0.6
Creation-Date: 2022-11-17T02:03:30+02:00

====== Zim ======

[ @console @zim @shortcuts ]

Десктопный вики-редактор, работает в режиме Markdown с файлами с расширением .txt

Также можно устроить [[+Подключение к блокноту Zim по ssh]]

===== Установить =====

* [[Debian:Install:zim]]

===== Настроить оформление =====

В каталоге ''~/.config/zim/'' заменить файл [[./style.conf]] 

	С цветом текста можно переборщить, но лучше не надо.

Изменения применятся только после перезапуска Zim. Если перезапустил, но они не подтягиваются, вероятно, Zim всё ещё где-то открыт. Можно грохнуть его процесс полностью.

См. https://github.com/testitquickly/bystro.linux/wiki/%D0%9D%D0%B0%D1%81%D1%82%D1%80%D0%BE%D0%B9%D0%BA%D0%B0-%D1%82%D1%91%D0%BC%D0%BD%D0%BE%D0%B9-%D1%82%D0%B5%D0%BC%D1%8B-Zim по натягиванию тёмной темы.

Настройки шаблонов происходят в [[~/.local/share/zim/templates]]

==== Цвета для тёмной темы ====

* Цвет фона = #18191d
* Цвет текста = #B2B2B2

Полностью “black #000“ и “white #fff“ смотрится слишком грубо 

	*todo Zim — можно маркер Ctrl+U сделать светлее или темнее? Как будет смотреться в темной теме

===== Быстрые настройки =====

Для примера смотрим версию Zim ''0.75.1''

Мне оказались нужны следующие модули:

	* Вставка диаграмм (надо ''sudo apt install graphviz'' )
	* Контроль версий
	* Метки
	* Оглавление
	* Панель закладок
	* Панель инструментов
	* Панель пути
	* Печать в браузер
	* Просмотр исходника (надо ''sudo apt install libgtksourceview-4-dev'' )
	* Редактирование не отвлекаясь
	* Редактор таблиц
	* Содержание строк
	* Сортировщик строк
	* Список задач

''Правка''
''> Параметры''
''> Интерфейс''

Отметить галочками только эти элементы:
* Показывать элементы управления в оформлении окна
* Всегда использовать последнюю позицию курсора при открытии страницы
* Использовать свой шрифт (IBM Plex Sans Text)

''Правка''
''> Параметры''
''> Редактирование''

Отметить галочками только эти элементы:
* Автоматически делать ссылками названия страниц вики
* Автоматически делать ссылками идентификаторы, начинающиеся с "#"
* Автоматически выделять текущее слово при применении форматирования
* Удаление отступов по [Backspace]
* Повторение нажатий вызывает цикличную смену статуса чек-бокса
* Изменение отступа элемента списка изменяет отступы подэлементов

''Правка''
''> Параметры''
''> Горячие клавиши''

Раньше работали такие настройки:
* [Actions]/NotebookView/apply_format_bullet_list Alt+1
* [Actions]/NotebookView/apply_format_numbered_list Alt+2

Сейчас нет.  Ctrl+1 работает.

Настроить перетаскивание элементов

'''
Параметры 
> Настройки
> Модули
> Содержание страницы
> Настроить
'''

Положение в окне: Левая боковая панель
Использовать перетаскивание для перемещения страниц в блокноте: Да

===== Настроить шорткаты =====

Горячие клавиши настраиваются как угодно. 

Шорткаты по-умолчанию:

* [F11] для перехода в полный экран и обратно
* [F9] показать/спрятать боковую панель с содержанием

Важно сразу удалить 

''[Actions]/NotebookView/zoom_reset''

Там по-умолчанию “Ctrl+0”, и эта настройка принудительно меняет заданный в параметрах размер шрифта. Приговорить её к Даблклику и [Backspace]:

| Клавиши      | Задача                                       |
|:-------------|:---------------------------------------------|
| ctrl+1/2/3/4 | Сделать строку заголовком уровня h1/h2/h3/h4 |
| ctrl+up/down | Переместить вверх/вниз всю строку            |
| ctrl+t       | Текст-стенограмма                            |
| ctrl+*       | Ненумерованный список                        |
| сtrl+#       | Нумерованный список                          |

==== Перейти к другой странице без мыши ====

''Ctrl+J''

начать набирать имя страницы. Местонахождение и вложенность несущественны, все возможные совпадения начнут подтягиваться по мере набора.

==== Сделать список ====

''Правка''
''> Параметры''
''> Горячие клавиши''

Назначить:

* <Actions>/NotebookView/apply_format_bullet_list = ''Ctrl+*''
* <Actions>/NotebookView/apply_format_numbered_list = ''Ctrl+#''

Ненумерованный список:

* выделить строки, 
* применить ''Ctrl+Shift+8''

Нумерованный список:

1. выделить строки, 
2. применить ''Ctrl+Shift+3''

==== Show word count ====

* <Actions>/NotebookView/show_word_count = ''F3''

===== Создать новую страницу =====

''Файл''
''> Создать страницу''

Или

''Ctrl+Shift+N''

Если начать набор с двоеточия — увидим существующие страницы первого уровня. Каждый следующий уровень доступен опять же через двоеточие.

==== Создать новую подстраницу ====

''Посмотреть в Содержании список всех страниц''
''> пройти к нужной,''
''> правой кнопкой по ней «Создать подстраницу»''

Или с любого места на любой странице:

''Ctrl+L («Вставить ссылку»)''

В поле «Ссылка на» начать набор названия новой страницы — она автоматически будет создана в корне блокнота.

Если страница должна быть дочерней (под другой страницей), то надо начать набор названия страницы, после её полного имени (оно подтянется) набрать двоеточие и набрать название создаваемой страницы. Её название также автоматически появится в поле «Текст». Бац-бац — ссылка готова!

Также в Параметры > Редактирование Zim можно включить/отключить несколько способов автоматического создания ссылок на новые страницы. Может показаться, что самый удобный случай — символ ''#'' перед словом автоматически превращает слово в ссылку. Но удобно оно работает только как ссылка на разделы внутри страница, на которой эта ссылка создаётся…

==== Переместить выделенный текст в новую страницу ====

Выделить произвольный текст: 

или

''Инструменты'' 
''> Переместить выделенный текст…''

или

'''
правой кнопкой 
'''
''> Переместить выделенный текст…''

или настроить шорткат

''Правка''
''> Параметры''
''> Горячие клавиши''
''> <Actions>/NotebookView/move_text''

Назначить подходящее сочетание, например, ''Ctrl+0''

===== Шаблон новых страниц =====

''Правка''
''> Шаблоны''
''> wiki''
''> Default''
''> Правка''

Шаблон будет открыт во внешнем редакторе (например, Kate). 

Содержимое шаблона wiki:

''[% page.basename %]''
''[% gettext("Created") %> [% strftime("%A %d %B %Y") %]''

Первую строку убирать нельзя, в ней заголовок страницы.

Вторая строка опциональна.

Можно добавить новые строки с произвольным содержимым.

===== Полноэкранный режим =====

''Правка'' 
''> Параметры'' 
''> Модули'' 
''> «Редактирование не отвлекаясь»'' 
''> Настроить''

Настроить “Максимальная ширина страницы” и “Ширина границы” по вкусу (и монитору).  На мониторе 2К мне ок 1600 и 25. На меньших размерах мне ок 1200 и 25.

===== Настроить TODO =====

Любопытно, что эта настройка распространяется только на один блокнот. Для других блокнотов её надо будет выполнить отдельно.

''Правка''
''> Параметры''
''> Модули''
''> «Список задач»''
''> Свойства''
''> Метки для задач''

Вставить это

''FIXME, TODO, *todo''

Теперь если в начале строки будет слово «''*todo''» — вся строка автоматически будет записана в список задач. 

Учесть, что по-умолчанию в Zim символ решетки создаёт ссылку на разделы внутри страницы. Если хочется использовать решетку для тудух, надо сперва снять галочку «//Автоматически делать ссылками идентификаторы, начинающиемя с '#'//» в

''Параметры'' 
''> Редактирование''

==== Приоритеты задач ====

Если после слова «''*todo''» (или в конце всей строки) поставить один восклицательный знак, то приоритет задачи будет повышен. Три восклицательных знака — самый высокий приоритет.

И лучше строки с *todo начинать с отступа.

{{{code: lang="html" linenumbers="True"
*todo ! <-> Пример задачи
}}}

==== Даты в задачах ====

Также можно вставлять дату начала задачи (чтобы потом было постоянно стыдно, что пропустил):

''TODO Call Susan to invite for diner 2017-12-11''

Но дата «работает» только в формате Год-Месяц-День и только через тире. И только если задача объявлена через TODO, который я как раз отключил. 

Неудобно.

==== Метки в задачах ====

Можно вставлять метки (тэги):

''TODO Buy rice @groceries''

Но метки из задач работают неадекватно.

===== Запуск zim из ярлыка =====

==== Создать ярлык в Dolphin ====

''Правой кнопкой мыши''
''> Создать''
''> Ссылку на приложение''

==== Создать ярлык в меню приложений ====

''cd ~/.local/share/applications/''

Назовём ярлык „Whisper”:

''mcedit Whisper.desktop''

Вставить это

{{{code: lang="sh" linenumbers="True"
[Desktop Entry]
Name=Whisper
Comment=zim notebook
Exec=zim /home/astenix/Dropbox/Notebooks/Whisper/notebook.zim index
Path=/home/astenix/Dropbox/Notebooks/Whisper/
Icon=/home/astenix/Dropbox/Notebooks/Whisper/icon/icona.ico
Type=Application
Terminal=false
StartupNotify=true
Categories=Other;
}}}

Проверочный запуск из консоли:

''gtk-launch bystro.linux''

Через какое-то время появится ярлык на новое приложение в Меню приложений > Прочее

Его можно «затащить» на тулбар.

==== Заполнить поля ярлыка ====

Вкладка: «Приложение»
Программа: ''zim''
Аргументы: ''~/путь/к/соответствующему/файлу/notebook.zim''
Рабочий путь: ''~/путь/к/соответствующему/файлу/''

Если оставить так, то по-умолчанию будет открываться условный главный файл в блокноте — «Home».  А его может не быть. Поэтому можно

==== Указать открытие определённого файла ====

в блокноте, который будет открываться. Преположим, он называется «Fluggegecheimen». Указывать расширение файла не нужно, достаточно только названия:

Аргументы: ''~/путь/к/соответствующему/файлу/notebook.zim Fluggegecheimen''

Если файл с указанным названием отсутствует, или в названии допущена ошибка, то в блокноте zim будет автоматически создан новый файл с соответствующим названием. 

=== Указать открытие файла с составным названием ===

Есть страница с пробелами в названии — «Six Myths of Product Development». Пробелы в названии надо заменить нижним подчеркиванием.

Аргументы: ''~/путь/к/соответствующему/файлу/notebook.zim Six_Myths_of_Product_Development''

=== Указать открытие файла NOT на английском языке ===

Если система поддерживает нужный язык и корректно отображат нужные символы (скорее всего, это будет текст в кодировке UTF-8), то название файла можно указать на соответствующем языке. Вот пример ссылки на файл с названием на русском языке:

Аргументы: ''~/путь/к/соответствующему/файлу/notebook.zim мадам_Козятина''

=== Указать открытие файла в иерархии страниц ===

Есть страница «Defect Management», под которой находится страница «Six Myths of Product Development». Путь к нужному файлу надо представить как иерархию страниц через двоеточие:

Аргументы: ''~/путь/к/соответствующему/файлу/notebook.zim Defect_management:Six_Myths_of_Product_Development''

Ограничений по глубине вложенности нет.

=== Указать открытие файла с переходом к определенной главе ===

Есть страница «Defect Management», под которой находится страница «Six Myths of Product Development», в которой есть глава «Search for a solution?».

Внутренняя ссылка указывается через символ „#”. Надо заменить все пробелы в подзаголовке к которому надо перейти символом „-”. Заглавные буквы можно использовать, а можно и нет — регистр не учитывается.

Аргументы: //~/путь/к/соответствующему/файлу/notebook.zim Defect_management:Six_Myths_of_Product_Development#search-for-a-solution//

===== Плагины =====

==== Вставить html с форматированием ====

Это добавляемая возможность через плагин https://github.com/cetinkaya/pastefromhtml

Не факт, что всё будет работать безупречно.

1. Потушить Zim полностью
2. Установить плагин

''mkdir ~/.local/share/zim/plugins''
''cd ~/.local/share/zim/plugins; git clone https://github.com/cetinkaya/pastefromhtml.git''

3. Открыть Zim

Правка > Параметры > Модули

Поставить галочку у „Paste from HTML”

Там же можно настроить поведение — вставлять скопированные изображения в блокнот или представлять их в виде ссылок на внешние ресурсы. Первое надёжнее, второе проще.

4. Вставка скопированного html:

* или в меню Инструменты > Paste from HTML (Ctrl+Shift+V)
* или по правому клику мышкой

==== Просмотр исходника ====

Возможность вставить код почти любого ЯП в страницы блокнота.

Установить 

 ''sudo apt-get -y install libgtksourceview-5-0 gir1.2-gtksource''

Вероятно, сперва надо будет проверить доступную версию ''libgtksourceview''

Затем включить модуль:
 
''Правка''
''> Параметры''
''> Модули''
''> Просмотр исходника''

Посмотреть его настройки. Лучшая тема оформления, имхо, oblivion.

Вставить код на странице в блокноте:

1. Сперва

''Вставка''
''> Блок кода''

2. Затем в предложенную строку вставить нужный код.

В окне выбрать синтаксис нужного языка программирования и (опционально) идентификатор. 

==== Отключить автоматическое сохранение в контроле версий ====

''Правка''
''> Параметры''
''> Модули''
''> «Контроль версий»''
''> Настроить''

Убедиться в том, что и автоматическое, и регулярное сохранения версий отключены, иначе в git начнут попадать один за другим коммиты с идентичным текстом «Автоматически сохранённая версия».

==== Textview prefs ====

Ограничивает ширину текста для удобства чтения. Устанавливает отступы (поля) вокруг текста со всех сторон. Плагин частично перекрывает настройки style.conf (см. [[#Цвета для тёмной темы]]), поэтому если цвет фона и текста нестандартны, их надо заново прописать в настройках этого плагина.

1. погасить Zim
2. скачать zip — https://framagit.org/rui.nibau/zim-plugin-textview-prefs/-/blob/e76aace119f26592cd433b343b938ee35c2092f1/build/textview-prefs-1.0.zip
3. распаковать его в ''~/.local/share/zim/plugins/textview-prefs''
4. запустить Zim
5. Правка > Параметры > Модули > включить Textview Preferences > Настроить:

* Left margin: ''12''
* Right margin: ''14''
* Ширина границы: ''12'' (влияет на отступ списков)
* Wrap Spacing: ''0''
* Цвет фона = ''#18191d''
* Цвет текста = ''#B2B2B2''
