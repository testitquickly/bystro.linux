Content-Type: text/x-zim-wiki
Wiki-Format: zim 0.6
Creation-Date: 2025-10-28T04:38:26+02:00

====== mpv ======

[ @mpv @video @subtitles ]

Условно простой, но замечательный видеоплеер, поверх которого наворотили тот же [[SMPlayer]]. 

Особенности:

* нельзя переназначить шорткаты
* нет плэйлистов, надо сделать текстовый файл с перечнем видео в каталоге (или в разных каталогах) через ''ls > list.m3u'' и запустить плеер из консоли с этим файлом как параметр: ''mpv list.m3u''

===== Шорткаты =====

Стандартные

''#''	(shift+3) Поменять аудиодорожку 
''J''	Поменять дорожку с субтитрами
''I'' 	Техно информация (быстро исчезает, чтобы прочитать всё, надо удерживать клавишу)
''.''	Кадр вперед
'',''	Кадр назад
'']''	Увеличить скорость
''[''	Уменьшить скорость

Глянуть весь список параметров (их более тысячи, многие deprecated):

''mpv --list-options > mpv_options.txt && sublime mpv_options.txt''

Задать свои:

''mcedit ~/.config/mpv/input.conf''

Например:

''# Смена аудиодорожки''
''Ctrl+1 cycle audio 1''
''Ctrl+2 cycle audio -1''

''# Смена субтитров''
''Ctrl+3 cycle sub 1''
''Ctrl+4 cycle sub -1''

''# Изменение размера субтитров''
''Ctrl+5 add sub-font-size 6''
''Ctrl+6 add sub-font-size -6''

Установить что-то на глобальные хоткеи вроде Ctrl+W нельзя, глобальные сочетания приоритетнее.

При смене размера субтитров отображается временно устанавливаемый размер. Его можно задать постоянно — в другом файле:

''mcedit ~/.config/mpv/mpv.conf''

''# Размер субтитров''
''sub-font-size=38''

Учесть, что в разных видеофайлах размер субтитров будет разным, и где-то 38 будет восприниматься как неудобно мелкий.

===== Задать задержку субтитров =====

Субтитры к сериалу подготовлены для телеверсии, в которой каждая серия начинается с раздела «в предыдущих сериях». А ты смотришь набор серий, в которых все эти «в предыдущих» вырезаны. Условно, каждый раз надо запускать субтитры на минус 24 секунды (24 000 ms).

==== Управление задержкой и опережением субтитров ====

Через клавиши ''x'' и ''z''. Более длинные смещения (по секунде) через ''shift+x'' и ''shift+z''. 

==== Задать смещение из консоли mpv ====

* во время воспроизведения вызвать консоль через ''`'' (клавиша на Ё)
* написать (руками, вставить текст невозможно)
''set sub-delay -24''
* убрать командное окно через Esc

Можно и точнее: 24 секунды и 700 миллисекунд = ''24.7''

Если нужно поправить смещение: клавиши ''x'' и ''z''.

==== Запускать файл сразу с заданным смещением субтитров ====

''mpv --sub-delay=-24 --sub-file=серия01.srt серия01.mkv''

Если субтитры вшиты — убрать параметр “''--sub-file''”.

Можно даже сделать алиас:

''alias mpvs='mpv --sub-delay=-24'''

=== Обработать все файлы srt ===

Из командной строки можно сделать копию файла с субтитрами, в которых все тайминги смещены на эти самые 24 000 ms:

''ffmpeg -itsoffset -24 -i input.srt -c copy output.srt''

Пакетное применение:

''for f in *.srt; do''
	''ffmpeg -itsoffset -24 -i "$f" -c copy "fixed_$f"''
''done''

Но для этого нужны специфические предусловия, иначе повсюду начнутся ошибки. Поэтому сперва надо делать всё руками, и только потом автоматикой.
