Content-Type: text/x-zim-wiki
Wiki-Format: zim 0.6
Creation-Date: 2025-07-29T00:28:48+03:00

====== fluidsynth ======

[ @midi @keyboard @sound ]

–ü—Ä–æ—Å—Ç–æ–π –ø—Ä–æ–∏–≥—Ä—ã–≤–∞—Ç–µ–ª—å –¥–ª—è midi-–∫–ª–∞–≤–∏–∞—Ç—É—Ä. –ï—Å–ª–∏ –≤ –Ω—ë–º –≤—Å—ë –±—É–¥–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å, —Ç–æ–≥–¥–∞ –º–æ–∂–Ω–æ –ø–µ—Ä–µ–∫–ª—é—á–∏—Ç—å—Å—è –Ω–∞ [[Hardware:usb midi-keyboard:Carla]].

–ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞ ‚Äî [[vmpk]]

	*todo –ú–∏–¥–∏–∫–ª–∞–≤–∏–∞—Ç—É—Ä–∞2 

–ù–µ–æ–±—Ö–æ–¥–∏–º–æ–µ –ü–û
1. MIDI-—Å–µ—Ä–≤–µ—Ä: jack –∏–ª–∏ pipewire
–†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è: PipeWire (—É–∂–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –≤ Manjaro KDE –∏ GNOME)

–ü—Ä–æ–≤–µ—Ä—å, —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –ª–∏ –æ–Ω:

pactl info

–ï—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è PipeWire, –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å Server Name: PulseAudio (on PipeWire x.y.z). –ï—Å–ª–∏ –Ω–µ—Ç ‚Äî —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å:

sudo pacman -S pipewire pipewire-alsa pipewire-jack pipewire-pulse wireplumber

2. –£—Ç–∏–ª–∏—Ç–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è MIDI: qjackctl, aconnect, patchage

–ï—Å–ª–∏ PipeWire:

sudo pacman -S qjackctl patchage

3. –°–∏–Ω—Ç–µ–∑–∞—Ç–æ—Ä: fluidsynth + –∑–≤—É–∫–æ–≤–æ–π –±–∞–Ω–∫ (soundfont)

sudo pacman -S fluidsynth soundfont-fluid

–ü–æ–¥–∫–ª—é—á–∏ –∫–ª–∞–≤–∏–∞—Ç—É—Ä—É. –ü–æ—Å–º–æ—Ç—Ä–∏, –≤–∏–¥–∏—Ç –ª–∏ –µ—ë —Å–∏—Å—Ç–µ–º–∞:

''aconnect -i''

–ó–∞–ø—É—Å–∫ fluidsynth:

''fluidsynth -a pipewire -m alsa_seq /usr/share/soundfonts/FluidR3_GM.sf2''

–î–æ–ª–∂–Ω–æ –ø–æ—è–≤–∏—Ç—å—Å—è –ø—Ä–∏–≥–ª–∞—à–µ–Ω–∏–µ >, –∂–¥—É—â–µ–µ MIDI-—Å–æ–±—ã—Ç–∏–π.

–ü–æ–¥–∫–ª—é—á–∏ MIDI-–∫–ª–∞–≤–∏–∞—Ç—É—Ä—É –∫ fluidsynth:

aconnect 'X2 Mini MIDI' 'FluidSynth'

–ï—Å–ª–∏ –Ω–µ –∑–Ω–∞–µ—à—å —Ç–æ—á–Ω—ã–µ –∏–º–µ–Ω–∞:

aconnect -i
aconnect -o

‚úÖ –†–µ–∑—É–ª—å—Ç–∞—Ç

–ö–æ–≥–¥–∞ –≤—Å—ë –Ω–∞—Å—Ç—Ä–æ–µ–Ω–æ:

	–ù–∞–∂–∏–º–∞–µ—à—å –∫–ª–∞–≤–∏—à–∏ ‚Äî –∑–≤—É–∫ –∏–¥—ë—Ç —á–µ—Ä–µ–∑ —Å–∏—Å—Ç–µ–º–Ω–æ–µ –∞—É–¥–∏–æ

	–ù–µ—Ç –∑–∞–¥–µ—Ä–∂–µ–∫ (–µ—Å–ª–∏ PipeWire –Ω–∞—Å—Ç—Ä–æ–µ–Ω –Ω–æ—Ä–º–∞–ª—å–Ω–æ)

üõ† –ï—Å–ª–∏ —Ö–æ—á–µ—à—å —Ç–æ–ª—å–∫–æ –∏–≥—Ä–∞—Ç—å (–±–µ–∑ –∑–∞–ø–∏—Å–∏ –∏–ª–∏ —Å–ª–æ–∂–Ω—ã—Ö DAW)
–ú–∏–Ω–∏–º–∞–ª–∏—Å—Ç–∏—á–Ω—ã–π –≤–∞—Ä–∏–∞–Ω—Ç:

fluidsynth -a pipewire -m alsa_seq /usr/share/soundfonts/FluidR3_GM.sf2



–í–æ—Ç –º–∏–Ω–∏–º–∞–ª–∏—Å—Ç–∏—á–Ω—ã–π —Å–∫—Ä–∏–ø—Ç, –∫–æ—Ç–æ—Ä—ã–π:

	–ó–∞–ø—É—Å–∫–∞–µ—Ç fluidsynth —Å –Ω—É–∂–Ω—ã–º soundfont'–æ–º

	–ñ–¥—ë—Ç –ø–æ—è–≤–ª–µ–Ω–∏—è MIDI-–∫–ª–∞–≤–∏–∞—Ç—É—Ä—ã (–Ω–∞–ø—Ä–∏–º–µ—Ä, X2 Mini)

	–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–æ–¥–∫–ª—é—á–∞–µ—Ç –µ—ë –∫ fluidsynth

	–û—Å—Ç–∞–≤–ª—è–µ—Ç –≤—Å—ë —Ä–∞–±–æ—Ç–∞—Ç—å –¥–æ –æ—Å—Ç–∞–Ω–æ–≤–∫–∏ —á–µ—Ä–µ–∑ Ctrl+C

üìù midi-piano.sh

{{{code: id="midi-piano.sh" lang="sh" linenumbers="True"
#!/bin/bash

# Soundfont
SF2="/usr/share/soundfonts/FluidR3_GM.sf2"

# –ù–∞–∑–≤–∞–Ω–∏–µ –∫–ª–∞–≤–∏–∞—Ç—É—Ä—ã (–º–æ–∂–Ω–æ –∑–∞–º–µ–Ω–∏—Ç—å –Ω–∞ —á–∞—Å—Ç—å —Å—Ç—Ä–æ–∫–∏, –Ω–∞–ø—Ä–∏–º–µ—Ä, "X2")
MIDI_NAME="X2 Mini"

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –Ω–∞–ª–∏—á–∏–µ soundfont
if [ ! -f "$SF2" ]; then
	echo "‚ùå SoundFont –Ω–µ –Ω–∞–π–¥–µ–Ω: $SF2"
	exit 1
fi

# –ó–∞–ø—É—Å–∫ fluidsynth
echo "üöÄ –ó–∞–ø—É—Å–∫ FluidSynth..."
fluidsynth -a pipewire -m alsa_seq "$SF2" &
FS_PID=$!

# –ù–µ–º–Ω–æ–≥–æ –ø–æ–¥–æ–∂–¥–∞—Ç—å, –ø–æ–∫–∞ fluidsynth –ø–æ–¥–Ω–∏–º–µ—Ç—Å—è
sleep 2

# –û–∂–∏–¥–∞–Ω–∏–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è MIDI-–∫–ª–∞–≤–∏–∞—Ç—É—Ä—ã
echo "üéπ –û–∂–∏–¥–∞–Ω–∏–µ MIDI-–∫–ª–∞–≤–∏–∞—Ç—É—Ä—ã '$MIDI_NAME'..."
while true; do
	MIDI_PORT=$(aconnect -i | grep -i "$MIDI_NAME" | grep client | awk '{print $2}' | sed 's/://')
	if [ -n "$MIDI_PORT" ]; then
		echo "‚úÖ –ù–∞–π–¥–µ–Ω–∞ –∫–ª–∞–≤–∏–∞—Ç—É—Ä–∞ –Ω–∞ –ø–æ—Ä—Ç—É $MIDI_PORT"
		break
	fi
	sleep 1
done

# –ù–∞–π—Ç–∏ –ø–æ—Ä—Ç FluidSynth
FS_PORT=$(aconnect -o | grep "FLUID Synth" | awk '{print $2}' | sed 's/://')
if [ -z "$FS_PORT" ]; then
	echo "‚ùå –ù–µ –Ω–∞–π–¥–µ–Ω –ø–æ—Ä—Ç FluidSynth"
	kill $FS_PID
	exit 1
fi

# –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ MIDI ‚Üí FluidSynth
echo "üîó –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ $MIDI_PORT ‚Üí $FS_PORT"
aconnect "$MIDI_PORT" "$FS_PORT"

echo "üéµ –ì–æ—Ç–æ–≤–æ! –ò–≥—Ä–∞–π—Ç–µ –Ω–∞ –∫–ª–∞–≤–∏–∞—Ç—É—Ä–µ. –ù–∞–∂–º–∏—Ç–µ Ctrl+C –¥–ª—è –≤—ã—Ö–æ–¥–∞."

# –û–∂–∏–¥–∞–Ω–∏–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è
wait $FS_PID
}}}

–°–æ—Ö—Ä–∞–Ω–∏ –≤ —Ñ–∞–π–ª:

''mcedit ~/midi-piano.sh''

–°–¥–µ–ª–∞—Ç—å –∏—Å–ø–æ–ª–Ω—è–µ–º—ã–º:

''chmod +x ~/midi-piano.sh''

–ó–∞–ø—É—Å–∫:

''./midi-piano.sh''

–°–∫—Ä–∏–ø—Ç –±—É–¥–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å, –µ—Å–ª–∏:

	–£—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã fluidsynth, alsa-utils, pipewire, wireplumber

	–ö–ª–∞–≤–∏–∞—Ç—É—Ä–∞ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è —á–µ—Ä–µ–∑ aconnect -i (–º–æ–∂–Ω–æ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –≤—Ä—É—á–Ω—É—é)

	–ó–≤—É–∫ –Ω–∞—Å—Ç—Ä–æ–µ–Ω –Ω–æ—Ä–º–∞–ª—å–Ω–æ (PipeWire —Ä–∞–±–æ—Ç–∞–µ—Ç, –∑–≤—É–∫ –∏–¥—ë—Ç)

