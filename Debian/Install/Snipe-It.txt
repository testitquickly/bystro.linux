Content-Type: text/x-zim-wiki
Wiki-Format: zim 0.6
Creation-Date: 2025-09-26T01:14:41+03:00

====== Snipe-It ======

[ @debian @install @web @snipeit ]

Управление через Docker Compose (см. [[Docker]]).

Сделать отдельный каталог:

''mkdir ~/snipeit; cd ~/snipeit''

Сгенерировать api-ключ для проекта:

'''
docker run --rm snipe/snipe-it php artisan key:generate --show
'''

Пример ответа:

''base64:AXS793LpP53 —'' и тд

Сделать конфиг:

''mcedit docker-compose.yml''

Вписать все параметры:

* с учетом полученного ключа API
* для простоты все пароли «''inventory123''» (так не должно быть)
* порт по-умолчанию ''8080'', я задал ''8090''
* все данные будут храниться в каталоге ''/home/astenix/snipeit'', а через двоеточие мы скажем Docker условный каталог, в котором якобы будут находиться данные томов, потому что ''/var/lib/mysql'' — обязательный путь внутри контейнера MySQL.

{{{code: lang="yaml" linenumbers="True"
services:
  mysql:
    image: mysql:8.0
    container_name: snipeit-mysql
    restart: always
    environment:
      MYSQL_ROOT_PASSWORD: inventory123
      MYSQL_DATABASE: snipeit
      MYSQL_USER: snipeit
      MYSQL_PASSWORD: inventory123
    healthcheck:
      test: ["CMD", "mysqladmin", "ping", "-h", "localhost"]
      interval: 7s
      timeout: 5s
      retries: 3
      start_period: 5s
    volumes:
      - /home/astenix/snipeit/mysql:/var/lib/mysql

  snipeit:
    image: snipe/snipe-it:latest
    container_name: snipeit-app
    depends_on:
      - mysql
    ports:
      - "8090:80"
    restart: always
    environment:
      APP_KEY: base64:AXS793LpP53 и тд
      APP_URL: http://inventory.local:8090
      DB_CONNECTION: mysql
      DB_HOST: mysql
      DB_DATABASE: snipeit
      DB_USERNAME: snipeit
      DB_PASSWORD: inventory123
      MAIL_DRIVER: smtp
      MAIL_HOST: smtp.mailtrap.io
      MAIL_PORT: 2525
      MAIL_USERNAME: null
      MAIL_PASSWORD: null
      MAIL_FROM: "bertram.gilfoyle@inventory.local"
    volumes:
      - /home/astenix/snipeit:/var/lib/snipeit

}}}

==== URL ====

Заморочиться с url, чтобы проект открывался не по http://localhost:8090, а по http://inventory.local:8090

Сперва локально — добавить запись об этом в

''sudo mcedit /etc/hosts''

На новой строке:

''127.0.0.1       inventory.local''

Сохранить, выйти.

Если надо, чтобы //все// устройства в сети заходили на ''inventory.local'' — привязать этот адрес к IP сервера в настройках роутера.

Важно помнить, что приложение по-умолчанию поднято на http, и для доступа снаружи надо отдельно поставить сертификат SSL, или в принципе пользоваться всем этим только внутри сети.

==== Запуск ====

В файл ~/.bashrc добавить команды

{{{code: lang="sh" linenumbers="True"
	# включить докер с Snipe-It
alias sklad+="cd /home/astenix/snipeit \
	&& docker compose up -d \
	&& timeout 60 bash -c 'until curl -s -o /dev/null -w \"%{http_code}\" http://localhost:8090 | grep -qE \"2|3\"; do sleep 1; done' \
	&& if [ $? -eq 0 ]; then 
		 firefox -p astenix --new-window http://inventory.local:8090;
	   else 
		 echo 'Отключение по таймауту (Snipe‑IT не запустился за 60 секунд)';
	   fi \
	&& echo -e \"\n   http://inventory.local:8090 \n\""

	# отключить докер с Snipe-It
alias sklad-="cd /home/astenix/snipeit && docker compose down && echo -e '\n   Докер погашен\n'"

}}}

Помнить о том, что текущий юзер должен входить в группу ''docker''.

См. далее [[Software:Snipe-It]]
